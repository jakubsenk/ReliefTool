@using ReliefWeb.Models
@model List<ReliefResult>
@{
	ViewBag.Title = "Relief";
}

<h2>Result</h2>
<style>
	td, th {
		padding: 3px 5px;
		min-width: 150px;
	}
</style>
@if (Model != null && Model.Count > 0)
{
	<table border="1" style="display: inline-table">
		<thead>
			<tr>
				<th>Algorithm</th>
				<th>Best column</th>
				<th>Calculation time</th>
			</tr>
		</thead>
		<tbody>
			@foreach (ReliefResult item in Model)
			{
				<tr>
					<td>@item.Name</td>
					<td>@item.BestScore.Key</td>
					<td>@item.Duration (@item.Duration.TotalMilliseconds)</td>
				</tr>
			}
		</tbody>
	</table>
	<br />
	<br />
	<table border="1" style="display: inline-table">
		<thead>
			<tr>
				<th>Column</th>
				@for (int i = 0; i < Model.Count; i++)
				{
					<th colspan="2">@Model[i].Name</th>
				}
			</tr>
		</thead>
		<tbody>
			@for (int i = 0; i < Model[0].Scores.Count; i++)
			{
				<tr>
					<td>@Model[0].Scores[i].Key</td>
					@for (int j = 0; j < Model.Count; j++)
					{
						if (Model[j].BestScore.Key == Model[j].Scores[i].Key)
						{
							<td colspan="2"><b>@Model[j].Scores[i].Value.ToString("N5")</b></td>
						}
						else
						{
							<td colspan="2">@Model[j].Scores[i].Value.ToString("N5")</td>
						}
					}
				</tr>
			}
			@if (Model[0].RemovedCount != null)
			{
				<tr>
					<td colspan="2">+@Model[0].RemovedCount.Value removed columns</td>
				</tr>
			}


			@if (Model[0].Clusters != null)
			{
				<tr>
					<td></td>
					@for (int i = 0; i < Model.Count; i++)
					{
						<td style="width: 200px">
							@for (int j = 0; j < Model[i].Sillhoutte.ClusterPairs.Count; j++)
							{
								@Html.Partial("BarChart", Model[i].Sillhoutte.ClusterPairs[j], new ViewDataDictionary() { { "id", "chart_sil_" + i + "_" + j }, { "color", Model[i].Sillhoutte.ClusterColors[j] } })
							}
						</td>

						<td style="width: 200px">
							@for (int j = 0; j < Model[i].SillhoutteAll.ClusterPairs.Count; j++)
							{
								@Html.Partial("BarChart", Model[i].SillhoutteAll.ClusterPairs[j], new ViewDataDictionary() { { "id", "chart_sil_all_" + i + "_" + j }, { "color", Model[i].SillhoutteAll.ClusterColors[j] } })
							}
						</td>
					}
				</tr>
				for (int j = 0; j < Model[0].Graphs.Count; j++)
				{
					<tr>
						<td></td>

						@for (int i = 0; i < Model.Count; i++)
						{
							<td>
								@Html.Partial("Chart", Model[i].Graphs[j], new ViewDataDictionary() { { "id", "chart_" + i + "_" + j } })
							</td>
							<td>
								@Html.Partial("Chart", Model[i].GraphsAll[j], new ViewDataDictionary() { { "id", "chart_" + i + "_" + j + "_o" } })
							</td>
						}
					</tr>
				}
			}
		</tbody>
	</table>
}